# Python package
# Create and test a Python package on multiple Python versions.
# Add steps that analyze code, save the dist with the build record, publish to a PyPI-compatible index, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/python

trigger:
- master

jobs:
# Mac and Linux use the same template with different matrixes
- template: buildscripts/azure/azure-linux-macos.yml
  parameters:
    name: Linux
    vmImage: ubuntu-latest
    matrix:
      py37_np1:
        CONDA_ENV: 'bodo'
        PYTEST_MARKER: not slow
        NP: 1
           
- template: buildscripts/azure/azure-linux-macos.yml
  parameters:
    name: macOS
    vmImage: xcode9-macos10.13
    matrix:
      py37_np1_firsthalf:
        CONDA_ENV: 'bodo'
        PYTEST_MARKER: not slow and firsthalf
        NP: 1
      py37_np1_secondhalf:
        CONDA_ENV: 'bodo'
        PYTEST_MARKER: not slow and not firsthalf
        NP: 1
      py37_np2_firsthalf:
        CONDA_ENV: 'bodo'
        PYTEST_MARKER: not slow and firsthalf
        NP: 2
      py37_np2_secondhalf:
        CONDA_ENV: 'bodo'
        PYTEST_MARKER: not slow and not firsthalf
        NP: 2
